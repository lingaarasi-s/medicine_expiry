<!DOCTYPE html>
<html>
<head>
    <title>New Sale</title>
</head>
<body>

<h2>üßæ New Sale Bill</h2>

<select id="medicine"></select><br><br>

<input type="number" id="qty" placeholder="Quantity"><br><br>
<input type="number" id="price" placeholder="Price per unit"><br><br>

<button onclick="sell()">Sell</button>

<p id="msg"></p>

<script>
fetch("http://localhost:8080/api/medicine/all")
.then(res => res.json())
.then(data => {
    const sel = document.getElementById("medicine");
    data.forEach(m => {
        sel.innerHTML += `<option value="${m.id}">
            ${m.name} (Stock:${m.quantity})
        </option>`;
    });
});

function sell() {
    const id = document.getElementById("medicine").value;
    const qty = document.getElementById("qty").value;
    const price = document.getElementById("price").value;

    fetch(`http://localhost:8080/api/billing/sell?medicineId=${id}&quantity=${qty}&price=${price}`, {
        method: "POST"
    })
    .then(res => res.json())
    .then(() => {
        document.getElementById("msg").innerHTML = "‚úÖ Sale completed";
    })
    .catch(err => {
        document.getElementById("msg").innerHTML = "‚ùå Sale failed";
    });
}
</script>

</body>
</html>
